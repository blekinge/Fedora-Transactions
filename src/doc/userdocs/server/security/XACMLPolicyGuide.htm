<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="XACMLPolicyGuide_files/filelist.xml">
<title>Sample Policy Guide: A Reference Collection XACML Policies for Fedora</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<link rel=Stylesheet type="text/css" media=all href="../../docstyle.css">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147482993 6144 0 0 31 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-believe-normal-left:yes;}
h1
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:110%;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h2
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h3
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:14.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h4
	{margin-top:1.5pt;
	margin-right:0in;
	margin-bottom:1.5pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:4;
	font-size:13.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h5
	{margin-top:1.5pt;
	margin-right:0in;
	margin-bottom:1.5pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	font-size:12.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
pre
	{font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
p.sect, li.sect, div.sect
	{mso-style-name:sect;
	margin-bottom:3.75pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.code, li.code, div.code
	{mso-style-name:code;
	margin:3.75pt;
	mso-pagination:widow-orphan;
	background:#DDDDFF;
	border:none;
	mso-border-alt:solid black .75pt;
	padding:0in;
	mso-padding-alt:4.0pt 4.0pt 4.0pt 4.0pt;
	font-size:12.0pt;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.reference, li.reference, div.reference
	{mso-style-name:reference;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.subsect, li.subsect, div.subsect
	{mso-style-name:subsect;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.subsect1, li.subsect1, div.subsect1
	{mso-style-name:subsect1;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.75pt;
	margin-left:15.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.subsect2, li.subsect2, div.subsect2
	{mso-style-name:subsect2;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.75pt;
	margin-left:15.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:317155235;
	mso-list-template-ids:679639406;}
@list l1
	{mso-list-id:439688067;
	mso-list-template-ids:937569026;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2
	{mso-list-id:441151582;
	mso-list-template-ids:852776862;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3
	{mso-list-id:595750641;
	mso-list-template-ids:-1253029196;}
@list l3:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l4
	{mso-list-id:788206181;
	mso-list-template-ids:-439825962;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l5
	{mso-list-id:1382821765;
	mso-list-template-ids:1499237698;}
@list l6
	{mso-list-id:1658681058;
	mso-list-template-ids:546053264;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><![if mso 9]>
<style>
p.MsoNormal
	{margin-left:15.0pt;}
</style>
<![endif]><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link=blue vlink=purple style='tab-interval:.5in;
margin-left:15.0pt;margin-top:15.0pt;margin-right:15.0pt;margin-bottom:15.0pt'>

<div class=Section1>

<div style='border:none;border-bottom:solid windowtext 1.0pt;mso-border-bottom-alt:
solid windowtext .75pt;padding:0in 0in 0in 0in;margin-bottom:7.5pt' id=header>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
style='font-family:Arial;color:black'><a href="../index.html"></a><o:p></o:p></span></p>

<h1 align=center style='text-align:center'><span style='font-family:Arial'>Fedora
XACML Policy Writing Guide<o:p></o:p></span></h1>

<h2 align=center style='text-align:center;mso-line-height-alt:15.0pt'><span
style='font-family:Arial'>With Reference Collection of Sample Policies for
Fedora<o:p></o:p></span></h2>

<p style='mso-line-height-alt:15.0pt'><b><span style='font-size:16.0pt;
font-family:Arial;color:black'>&nbsp;</span></b><span style='font-family:Arial;
color:black'><o:p></o:p></span></p>

</div>

<div>

<h2 style='mso-line-height-alt:15.0pt'><span style='font-family:Arial'>Table of
Contents<o:p></o:p></span></h2>

<div>

<ol start=1 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level1 lfo1;
     tab-stops:list .5in'><span style='font-family:Arial'><a href="#INTRO">Introduction</a>
     <o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level1 lfo1;
     tab-stops:list .5in'><span style='font-family:Arial'><a href="#POLICY">Writing
     Fedora XACML Policies</a><o:p></o:p></span></li>
</ol>

<ol start=2 type=1>
 <ul type=circle>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#POLICY-VOCAB">2.1 The Fedora Policy Vocabulary</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#POLICY-BASICS">2.2 Policy Basics:&nbsp; Identifier, Description,
      and Rule Combining Algorithm</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#POLICY-TARGET">2.3 Defining the Policy Target</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#POLICY-RULE">2.4 Defining Policy Rules</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#POLICY-FUNCTIONS">2.5 XACML Functions</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#POLICY-OPT-ATTRS">2.6 Required vs. Optional Attributes in a Policy</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#POLICY-BEST">2.7 Recommended Best Practices for Authoring Fedora
      XACML Policies</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#POLICY-GOTCHA">2.8 XACML Gotchas</a><o:p></o:p></span></li>
 </ul>
</ol>

<ol start=3 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level1 lfo1;
     tab-stops:list .5in'><span style='font-family:Arial'><a
     href="#DEFAULT-REPOWIDE">Default Repository Policies</a><o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level1 lfo1;
     tab-stops:list .5in'><span style='font-family:Arial'><a
     href="#CUSTOM-REPO-WIDE">Custom Policies - Sample Repository-Wide Policies</a><o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level1 lfo1;
     tab-stops:list .5in'><span style='font-family:Arial'><a
     href="#CUSTOM-OBJ-SPECIFIC">Custom Policies - Sample Object-Specific
     Policies</a><o:p></o:p></span></li>
</ol>

</div>

</div>

<div>

<h2 style='mso-line-height-alt:15.0pt'><a name=INTRO></a><span
style='font-family:Arial'>1 Introduction<o:p></o:p></span></h2>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>XACML
provides a very flexible language for expressing access control
policies.&nbsp;&nbsp; This document offers guidance on writing a range of
useful policies for Fedora such as 1) broad repository-wide policies for
controlling access to Fedora API operations,&nbsp; 2) more detailed
repository-wide policies for controlling access to groups of digital objects
based on various attributes, and 3) more fine-grained object-specific policies
for controlling access to individual digital objects.&nbsp;&nbsp;&nbsp; <b><i>It
should be noted that to help users who do not wish to learn native XACML, a
Policy Authoring Client is currently under development that will provide an
easy graphical user interface for creating XACML policies for Fedora.</i></b><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>This
guide also provides a&nbsp; collection of sample XACML policies is intended as
reference material to help in writing custom XACML policies for Fedora.&nbsp;
The sample policies demonstrate one possible authoring style for XACML, in
recognition that there are other ways to write XACML policies that have the
same effect.&nbsp;&nbsp;&nbsp; Most of the sample repository-wide policies are
authored to have a <b><i>single effect,</i></b> meaning that each policy has a
single rule that either permits or denies access.&nbsp;&nbsp; This style of
policy writing results in many individual policies, but each policy is atomic
and uncomplicated.&nbsp; An alternative is to have fewer policies, each with
multiple rules within.&nbsp;&nbsp; This multi-rule approach can result in more
complicated policies, but is, nevertheless, appropriate for writing <b><i>object-specific</i></b>
<b><i>policies</i></b> in Fedora where a single policy states all the rules for
a particular digital object.&nbsp;&nbsp;&nbsp; In either case, it is essential
to understand the policy combining algorithm that is configured for your
repository's XACML-based Authorization module.&nbsp; By default, the &quot;Deny
Overrides&quot; algorithm is configured in Fedora, which means that when
multiple policies are applicable to an incoming request, deny will trump
permit.&nbsp;&nbsp; As you add new policies to the mix, you must be aware of
what kinds of policies are already active in the repository.&nbsp;&nbsp;&nbsp;
Also, when writing a policy that contains more than one rule, you must
understand the the rule combining algorithm (which is specified in the root
element of an individual XACML policy).&nbsp; The sample policies use the
&quot;first-applicable&quot; rule combining algorithm, which means that the
first applicable rule in the policy will prevail. <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>This
document is not intended to be a comprehensive tutorial on writing XACML
policies.&nbsp;&nbsp; Anyone intending to author custom XACML policies for
Fedora is encouraged to read the following documentation provided by OASIS
Technical Committee that defined the XACML standard, and Sun who is the
provider of the open source Sun XACML engine that is used in the Fedora
implementation.&nbsp;&nbsp;&nbsp; It is very important to understand the basics
of XACML to ensure that a suite of policies works as intended.&nbsp;&nbsp; One
of the most important concepts in using XACML is understanding how multiple
policies can interact with each other (in good ways, or in ways you didn't intend).&nbsp;&nbsp;
By following the examples in this guide, you should be able to set up many
kinds of access control policies for your repository.&nbsp;&nbsp; With
additional help from the following documents, you should be able to do more
advanced policies, and change some of the XACML settings for how sets of
policies are combined.<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-family:Arial;color:black'>More
information on writing XACML policies:</span></b><span style='font-family:Arial;
color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'><br>
<a
href="http://docs.oasis-open.org/xacml/access_control-xacml-2_0-core-spec-cd-04.pdf">OASIS
XACML Specification</a>:&nbsp; this is the official specification and a good
reference document. <br>
<br>
<a
href="http://www.oasis-open.org/committees/download.php/2713/Brief_Introduction_to_XACML.html">A
Brief Introduction to XACML</a>:&nbsp; this is nice introduction to the XACML
concepts<br>
<br>
<a href="http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=xacml">OASIS
XACML Technical Committee</a>:&nbsp;&nbsp; this home page of the technical
committee provides access to other documents on XACML<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-family:Arial;color:black'>More
information on the Fedora security architecture:</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'><a
href="securingrepo.html">Securing Your Repository</a> : documentation on
security options and configuring configuring user authentication sources for
Fedora repositories<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'><a
href="AuthorizationXACML.htm">Fedora Authorization with XACML Policy
Enforcement</a> : documentation on configuration and implementation of the
Fedora XACML-based policy enforcement module<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'><a
href="AuthorizationXACML.htm#ATTR">Binding to user attributes to policies</a> :
a discussion of how to use attributes from different sources (e.g., Tomcat,
LDAP, Shibboleth) in policies<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><i><span style='font-family:Arial;color:black'>&nbsp;</span></i><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<div>

<h2 style='mso-line-height-alt:15.0pt'><a name=POLICY><span style='font-family:
Arial'>2&nbsp; Writing Fedora XACML Policies</span></a><span style='font-family:
Arial'><o:p></o:p></span></h2>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=POLICY-VOCAB><span style='font-family:
Arial'>2.1 The Fedora Policy Vocabulary</span></a><span style='font-family:
Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>A <a
href="xacml-policies/vocabulary.txt">Fedora-specific policy vocabulary</a> is
defined to enable the creation of XACML policies for Fedora repositories and digital
objects.&nbsp;&nbsp; This vocabulary define a set of URNs that can be used to
identify specific Fedora API operations, Fedora object attributes, and the
Fedora environment within an XACML policy.&nbsp;&nbsp; These URNs are used as
attribute designators in XACML policies, specifically within a
SubjectAttributeDesignator, ResourceAttributeDesignator,
ActionAttributeDesignator, or
EnvironmentAttributeDesignator.&nbsp;&nbsp;&nbsp;&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>The
set of identifiers defined for the Fedora policy vocabulary is automatically
generated on Fedora build and can be found in the Fedora software distribution
at:<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;Under
Windows:<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>%FEDORA_HOME%\server\fedora-internal-use\vocabulary.txt<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;Under
Unix:<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>$FEDORA_HOME\server\fedora-internal-use\vocabulary.txt<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>This
vocabulary provides a set of identifiers (URNs) that can appear in XACML
policies to refer to Fedora API operations (Actions in XACML), any aspects of a
Fedora digital object (Resources in XACML), key attributes of the environment
in which Fedora runs in (Environment in XACML), and common subject (i.e., user)
attributes.&nbsp; (Other user attributes are named according to site-usage and
so their names aren't included in the Fedora XACML vocabulary.) <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=POLICY-BASICS><span style='font-family:
Arial'>2.2 Policy Basics:&nbsp; Identifier, Description, and Rule Combining
Algorithm</span></a><span style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><b><span style='font-family:Arial;color:black'>&nbsp;</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Every
policy has an identifier, a rule combining algorithm, and a description.&nbsp;
In the root element of an XACML policy there is an attribute to provide the
policy with a unique identifier.&nbsp;&nbsp; Also, the &lt;Description&gt;
element provides a place to put a textual description of the purpose of the
policy.<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;Policy <b>PolicyId=&quot;deny-apia&quot; RuleCombiningAlgId=&quot;urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable&quot;<o:p></o:p></b></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>xmlns=&quot;urn:oasis:names:tc:xacml:1.0:policy&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span><b>&lt;Description&gt;This policy will DENY access to THESIS datastreams.&lt;/Description&gt;<o:p></o:p></b></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>    </span></span></b><span
style='color:black'>&lt;Target&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>...<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Target&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Rule&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>...<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Rule&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;/Policy&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>The
main body of a policy consists of a <b>Policy Target</b> and one or more <b>Rules</b>
which are described in the next sections.&nbsp; Note that in the root element
of a policy, the rule combining algorithm (i.e., attribute
&ldquo;RuleCombiningAlgID&rdquo;), specifies how the Fedora Policy Enforcement Module will
deal with multiple Rules in a policy (how those rules are combined and
evaluated together).&nbsp; This algorithm is valid for only the specific policy
containing it, and is independent of similar algorithms in other policies. It
governs how the various effects of the potentially several rules of a policy
are combined into the single effect of the policy as a whole. It is also
independent of the policy-combining algorithm operative for all policies
collectively, which governs how the various results of all policies are
combined into a single result. <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=POLICY-TARGET><span style='font-family:
Arial'>2.3 Defining the Policy Target</span></a><span style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>A Policy Target is the part of a policy that specifies
matching criteria for figuring out whether a particular policy is applicable to
an incoming service request.&nbsp;&nbsp; A Target contains three basic
&quot;matching&quot; components: <b>Subjects</b>, <b>Actions</b>, and <b>Resources</b>.&nbsp;
All of these components must be matched to the context of an incoming request
for the policy to be applicable.&nbsp;&nbsp; These matching specifications can
be built upon <a href="#POLICY-FUNCTIONS">XACML Functions</a>. (A fourth
matching component, Environments, is defined in XACML and will be available in
Fedora's XACML policies when it is available in the Sun XACML version as used
in Fedora.) <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;Policy PolicyId=&quot;deny-apia&quot; RuleCombiningAlgId=&quot;urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable&quot;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>xmlns=&quot;urn:oasis:names:tc:xacml:1.0:policy&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Description&gt;This policy will DENY access to THESIS datastreams.&lt;/Description&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Target&gt;<o:p></o:p></span></b></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;Subjects&gt;<o:p></o:p></span></b></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>            </span></span></b><span
style='color:black'>...<o:p></o:p></span></pre><pre style='line-height:15.0pt;
background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;/Subjects&gt;</span></b><span
style='color:black'><o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;Resources&gt;<o:p></o:p></span></b></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>            </span></span></b><span
style='color:black'>...<o:p></o:p></span></pre><pre style='line-height:15.0pt;
background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;/Resources&gt;</span></b><span
style='color:black'><o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;Actions&gt;<o:p></o:p></span></b></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>      </span><span style='mso-spacerun:yes'>      </span></span></b><span
style='color:black'>...<o:p></o:p></span></pre><pre style='line-height:15.0pt;
background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;/Actions&gt;<o:p></o:p></span></b></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Target&gt;<o:p></o:p></span></b></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>    </span></span></b><span
style='color:black'>&lt;Rule/&gt;<o:p></o:p></span></pre><pre style='line-height:
15.0pt;background:#DDDDFF'><span style='color:black'>&lt;/Policy&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>A
Policy Target can be specified for a Policy (or for a PolicySet, which is an
advanced way of grouping policies together).&nbsp; &nbsp;A &lt;Target&gt;
element is defined at the Policy level (as a child of the root &lt;Policy&gt;
element).&nbsp; A Policy Target applies to any contained Rules that are
expressed in that policy.&nbsp; However, a Rule may have its own Target, in
which case the Rule-level Target overrides &mdash; for that Rule only &mdash; the Policy level
Target.&nbsp; Typically, a Target defined at the Rule level is used to replace
and so tighten a broader match specification found at the overall Policy level.
(This is described below.)<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><b><span style='font-size:
10.0pt;font-family:"Courier New";color:black;background:white'>&lt;Resources&gt;</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span><span style='font-family:
Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><i><span style='font-family:
Arial;color:black'>All Fedora resources (objects, datastreams, disseminations)
have attribute identifiers defined in the Fedora policy vocabulary (see:
dist/server/config/xacml-policies/vocabulary.txt).&nbsp; </span></i><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span><span style='font-family:
Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>The &lt;Resources&gt; element of a Policy Target is used to
wrap one or more descriptions of the kinds of Fedora resources (objects,
datastreams, disseminations, etc.) that the policy should apply to.&nbsp; At
runtime, the Policy Enforcement Module will compare attributes of a requested
resource against the criteria in the &lt;Resources&gt; specification within the
policy Target to determine if the policy is applicable to the incoming request.
For example, to define a policy that is applicable to any Fedora resource, the
following is specified:<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-size:9.0pt;
font-family:"Courier New";color:black;background:white'>&nbsp;</span><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Resources&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;AnyResource/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Resources&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>Within a single &lt;Resource&gt; specification, there may be
one or more attributes that together determine whether a policy match should
occur.&nbsp; Each &lt;ResourceMatch&gt; element is used to specify the
name/value of an attribute of a Fedora resource<b>.&nbsp; </b>&nbsp;Multiple <b>&lt;ResourceMatch&gt;
</b>elements are used to specify multiple attributes of a resource, and are <b>logically
AND-ed together</b>.&nbsp; This means that for a policy to be applicable to an
incoming service request, <b><i>all</i></b> &lt;ResourceMatch&gt;
specifications must match the attributes of the requested Fedora resource.&nbsp;
The AttributeID in the &lt;ResourceAttributeDesignator&gt; element is used to
identify a particular resource attribute by a URN, as defined in the Fedora
policy vocabulary.&nbsp; In the example below, there are two attributes to
match on: &ldquo;urn:&hellip;datastream:id&rdquo; and &ldquo;urn:&hellip;mimeType&rdquo;.&nbsp; The snippet says that
a policy match will occur if the incoming request context indicates that the
requested resource has the datastream id of THESIS and the MIME type of
&ldquo;application/pdf.&rdquo;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Resources&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Resource&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;ResourceMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;ResourceAttributeDesignator AttributeId=&quot;urn:fedora:names:fedora:2.1:resource:<b>datastream:id</b>&quot; <o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>              </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;<b>THESIS</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;/ResourceMatch&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;ResourceMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;ResourceAttributeDesignator AttributeId=&quot; urn:fedora:names:fedora:2.1:resource:datastream:<b>mimeType</b>&quot; <o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>              </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;<b>application/pdf</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;/ResourceMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Resource&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'> <span style='mso-spacerun:yes'> </span>&lt;/Resources&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>To create an <b>OR</b> <b>condition</b> for resource
matching, multiple &lt;Resource&gt; elements must be specified.&nbsp;&nbsp; If
there are multiple <b>&lt;Resource&gt;</b> elements within the
&lt;Resources&gt; wrapper component, the &lt;Resource&gt; elements are <b>logically
OR-ed together</b>.&nbsp; This means that a match on only one of the Resource
specifications is necessary for the policy to apply to a service request.&nbsp;
For example, the snippet below says that a resource match will occur if the
incoming request is for a digital object that has the content model type of
either &ldquo;UVA_STD_IMAGE&rdquo; or &ldquo;MRSID.&rdquo;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Resources&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Resource&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;ResourceMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;<b>UVA_STD_IMAGE</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;ResourceAttributeDesignator AttributeId=&quot;urn:fedora:names:fedora:2.1:resource:<b>object:contentModel</b>&quot;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>              </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;/ResourceMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Resource&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Resource&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;ResourceMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;<b>MRSID</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;ResourceAttributeDesignator AttributeId=&quot;urn:fedora:names:fedora:2.1:resource:<b>object:contentModel</b>&quot;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>              </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;/ResourceMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Resource&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Resources&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><b><span style='font-size:
10.0pt;font-family:"Courier New";color:black;background:white'>&lt;Actions&gt;</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><i><span style='font-family:
Arial;color:black'>All Fedora service operations have an action identifier in
defined by the Fedora policy vocabulary (see:
dist/server/config/xacml-policies/vocabulary.txt).&nbsp; </span></i><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>The &lt;Actions&gt; element of a Policy Target is used to
wrap one or more service operations that this policy should apply to.&nbsp; At
runtime, the Policy Enforcement Module will compare the identity of an incoming
request against the criteria specific in the &lt;Actions&gt; of a Target in a
policy. &nbsp;For example, to define a policy that is applicable to <b><i>any</i></b>
Fedora service operation, the following is specified:<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;Actions&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;AnyAction/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;/Actions&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>From a practical standpoint in Fedora, there are only two
attributes that pertain to identifying Fedora API operations:&nbsp; 1) an
attribute that indicates what Fedora API is in context, and 2) an attribute
that indicates the specific service operation within that
API.&nbsp;&nbsp;&nbsp; To create a policy that is intended for an <i>entire</i>
service&nbsp; (e.g., ALL operations of API-A) do the following:<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;Actions&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Action&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;ActionMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;urn:fedora:names:fedora:2.1:action:<b>api-a</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;ActionAttributeDesignator AttributeId=&quot;urn:fedora:names:fedora:2.1:<b>action:api</b>&quot;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>              </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/ActionMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Action&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;/Actions&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>To create a policy that is about a specific operation in a
Fedora API do the following:<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;Actions&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Action&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;ActionMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;urn:fedora:names:fedora:2.1:action:<b>id-getDatastreamDissemination</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;ActionAttributeDesignator AttributeId=&quot;urn:fedora:names:fedora:2.1:<b>action:id</b>&quot;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>            </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/ActionMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Action&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;/Actions&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>The above can be considered a shortcut for fully qualifying
a service operation within its respective service API.&nbsp;&nbsp; An
alternative way to specify an Action as a Fedora API operation is to refer to
the Fedora service API <b>AND</b> the service operation.&nbsp;&nbsp;&nbsp; As
with &lt;SubjectMatch&gt; and &lt;ResourceMatch&gt; specifications, multiple <b>&lt;ActionMatch&gt;
</b>elements are <b>logically AND-ed together</b>. &nbsp;&nbsp;&nbsp; For
example the following snippet says that the policy will match if the incoming
request pertains to the Fedora API-A service AND the service request is for the
the &ldquo;getDatastreamDissemination&rdquo; operation.<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;Actions&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Action&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;ActionMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;urn:fedora:names:fedora:2.1:action:<b>api-a</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;ActionAttributeDesignator AttributeId=&quot;urn:fedora:names:fedora:2.1:<b>action:api</b>&quot;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>            </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/ActionMatch&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;ActionMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;urn:fedora:names:fedora:2.1:action:<b>id-getDatastreamDissemination</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;ActionAttributeDesignator AttributeId=&quot;urn:fedora:names:fedora:2.1:<b>action:id</b>&quot; <o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>            </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/ActionMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Action&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;/Actions&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>To create an <b>OR</b> <b>condition</b> for action matching,
multiple &lt;Action&gt; elements must be specified.&nbsp;&nbsp; If there are
multiple <b>&lt;Action&gt;</b> elements within the &lt;Actions&gt; wrapper
component, the &lt;Action&gt; elements are <b>logically OR-ed together</b>.&nbsp;
This means that a match on only one of the Action specifications is necessary
for the policy to apply to a service request.&nbsp; For example, the snippet
below says that a resource match will occur if the incoming request is <b><i>either</i></b>
the getDatastreamDissemination operation of API-A or the getDissemination
operation of API-A.&nbsp;&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><i><span style='font-family:
Arial;color:black'>Note:&nbsp; The &quot;shortcut&quot; method of referring to
a Fedora API operation is used in the example (i.e., we have an ActionMatch for
the specific Fedora API of &quot;api-a&quot;) because Fedora actions
identifiers are unique in themselves.&nbsp; Fedora automatically knows that the
getDatastreamDissemination operation is part of API-A. </span></i><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;Actions&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Action&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;ActionMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;urn:fedora:names:fedora:2.1:action:<b>id-getDatastreamDissemination</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;ActionAttributeDesignator AttributeId=&quot;urn:fedora:names:fedora:2.1:<b>action:id</b>&quot; <o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>            </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/ActionMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Action&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Action&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;ActionMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;urn:fedora:names:fedora:2.1:action:<b>id-getDissemination</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;ActionAttributeDesignator AttributeId=&quot;urn:fedora:names:fedora:2.1:<b>action:id</b>&quot;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>            </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/ActionMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Action&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;/Actions&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt'><b><span style='font-family:Arial;color:black'>&nbsp;</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-size:10.0pt;font-family:
"Courier New";color:black;background:white'>&lt;Subjects&gt;</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-size:10.0pt;font-family:
"Courier New";color:black;background:white'>&nbsp;</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><i><span style='font-family:
Arial;color:black'>The Fedora policy vocabulary (see:
dist/server/config/xacml-policies/vocabulary.txt) defines general-purpose
attributes for use in policies (e.g., login-id). &nbsp;However, attributes for subjects
will vary depending on what a repository uses as the source of user information
(e.g., tomcat-users.xml, LDAP, Shibboleth).&nbsp; &nbsp;Fedora XACML policies
can make reference to the identifiers of any subject attribute that can be
passed into Fedora from authenticating sources. &nbsp;See the section below on
&ldquo;Getting User Attributes into the Fedora Policy Enforcement Module&rdquo; for more
information on the sources of subject attributes.</span></i><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>The &lt;Subjects&gt; element of a Policy Target is used to
wrap one or more descriptions of users or agents that this policy should apply
to.&nbsp; At runtime, the Fedora Policy Enforcement Module will compare
attributes of the user/agent making a service request against the criteria
specific in the &lt;Subjects&gt; specification of the policy Target to
determine if the policy is applicable to the incoming request. &nbsp;&nbsp;For
example, to define a policy that is applicable to any kind of user or agent,
the following is specified:<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;
<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Subjects&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;AnySubject/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Subjects&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>Within a single &lt;Subject&gt; specification, there may be
one or more XACML attributes that together determine whether a policy match
should occur.&nbsp; Each &lt;SubjectMatch&gt; element is used to specify an
name/value of an attribute of a user/agent.<b> </b>&nbsp;Multiple <b>&lt;SubjectMatch&gt;
</b>elements are used to specify multiple attributes of a subject, and are <b>logically
AND-ed together</b>.&nbsp; This means that for a policy to be applicable to an
incoming service request, <b><i>all</i></b> &lt;SubjectMatch&gt; specifications
must match the attributes of the requesting user/agent.&nbsp; In the example
below, there is only one attribute to match on (i.e., &ldquo;fedoraRole&rdquo;).&nbsp; The
AttributeID in the &lt;SubjectAttributeDesignator&gt; element is used to
identify a particular subject attribute by its local or global identifier.&nbsp;
The snippet says that a policy match will occur if the incoming request context
indicates that the user/agent has a role attribute with the value of
&ldquo;administrator.&rdquo;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Subjects&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Subject&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;SubjectMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;<b>administrator</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;SubjectAttributeDesignator AttributeId=&quot;<b>fedoraRole</b>&quot; MustBePresent=&quot;false&quot; <o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>              </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;/SubjectMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Subject&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Subjects&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>To create an <b>OR</b> <b>condition</b> for subject
matching, multiple &lt;Subject&gt; elements must be specified.&nbsp;&nbsp; If
there are multiple <b>&lt;Subject&gt;</b> elements within the &lt;Subjects&gt;
wrapper component, the &lt;Subject&gt; elements are <b>logically OR-ed together</b>.&nbsp;
This means that a match on only one of the Subject specifications is necessary
for the policy to apply to a service request.&nbsp; For example, the snippet
below says that a subject match will occur if the requesting user has the role
of either &ldquo;administrator&rdquo; or &ldquo;superuser.&rdquo;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Subjects&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Subject&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;SubjectMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;<b>administrator</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;SubjectAttributeDesignator AttributeId=&quot;<b>fedoraRole</b>&quot; MustBePresent=&quot;false&quot; <o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>              </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;/SubjectMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Subject&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Subject&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;SubjectMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;<b>superuser</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;SubjectAttributeDesignator AttributeId=&quot;<b>fedoraRole</b>&quot; MustBePresent=&quot;false&quot; <o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>              </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;/SubjectMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Subject&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Subjects&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-size:10.0pt;font-family:
"Courier New";color:black;background:white'>&lt;Environments&gt;</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>The
Environments component of a Target is intended to specify aspects of the
runtime environment that would make the policy match the incoming
request.&nbsp;&nbsp;&nbsp; Such attributes include the current date, current
time, the IP address of the client, and the protocol being used for the
request.&nbsp;&nbsp; The <b>Environments</b> element is discussed in the OASIS
XACML specification, but it is <b><i>not yet implemented by the Sun XACML
engine</i></b> that underlies the Fedora Authorization module.&nbsp; This
prevents the expression of environment matching criteria within Targets.&nbsp; <o:p></o:p></span></p>

<blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'>

<p style='line-height:15.0pt'><b><i><span style='font-family:Arial;color:black'>**&nbsp;
</span></i></b><i><span style='font-family:Arial;color:black'>Therefore, in
Fedora 2.1 do not create policies that specify Environment matching criteria in
the policy Target.</span></i><span style='font-family:Arial;color:black'>&nbsp;
<o:p></o:p></span></p>

</blockquote>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Although
the Environments element is not currently supported for use within a Target,
this does not mean that you cannot encode matching criteria for environmental
attributes within a policy.&nbsp;&nbsp; Within a policy Rule, you can specify a
Condition that contains matching criteria for environmental attributes.&nbsp;
Refer to the discussion of policy rules below for an example of Environment
attribute matching in a Condition.<o:p></o:p></span></p>

<h4 style='line-height:15.0pt'><span style='font-family:Arial'>&nbsp;<o:p></o:p></span></h4>

<h3 style='line-height:15.0pt'><a name=POLICY-RULE><span style='font-family:
Arial'>2.4 Defining Policy Rules</span></a><span style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><b><span style='font-family:Arial;color:black'>&nbsp;</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Each
policy has at least one, and possibly more, rules. There must be at least one
Rule in a policy that matches the incoming request for a policy to be deemed
applicable to that request.&nbsp;&nbsp;&nbsp; The way the Sun XACML engine
determines whether a rule is applicable to an incoming request is by evaluating
the Target and optional Condition (if it exists).&nbsp;&nbsp; These are ANDed
together, and the rule's effect achieved if the ANDed value is TRUE. (If there
is no Condition, this result is simply the value of the Target.) The rule's
Target is so used, and if it has no Target, the policy's Target is used
instead.&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;Policy PolicyId=&quot;deny-apia&quot; RuleCombiningAlgId=&quot;urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable&quot;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>xmlns=&quot;urn:oasis:names:tc:xacml:1.0:policy&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Description&gt;This policy will DENY access to Dublin Core datastreams.&lt;/Description&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Target&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>...<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Target&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Rule RuleId=&quot;1&quot; Effect=&quot;Deny&quot;&gt;<o:p></o:p></span></b></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;Target&gt;<o:p></o:p></span></b></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>      </span><span style='mso-spacerun:yes'>     </span></span></b><span
style='color:black'>...<b><o:p></o:p></b></span></pre><pre style='line-height:
15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;/Target&gt;</span></b><span
style='color:black'><o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;Condition&gt;<o:p></o:p></span></b></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>           </span>...<o:p></o:p></span></b></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;/Condition&gt;<o:p></o:p></span></b></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><b><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Rule&gt;</span></b><span
style='color:black'><o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;/Policy&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF'><span style='font-family:"Lucida Console";
mso-bidi-font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='background-position-x:
0%;background-position-y:0%'><b><span style='font-size:10.0pt;font-family:"Courier New";
color:black;background:white'>&lt;Rule&gt;</span></span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>A policy contains one or more Rules.&nbsp; Each rule has a <b>RuleId</b>
and and <b>Effect</b>.&nbsp;&nbsp; An Effect is the intended consequence of a
satisfied rule, which can be either &quot;Deny&quot; or
&quot;Permit.&quot;&nbsp;&nbsp;&nbsp;&nbsp; This means that if the rule is
deemed applicable to an incoming service request, and the rule's conditions
evaluate to TRUE,&nbsp; then the specified effect should be enforced.<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='background-position-x:
0%;background-position-y:0%'><b><span style='font-size:10.0pt;font-family:"Courier New";
color:black;background:white'>&lt;Target&gt;</span></span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>Each Rule in a policy can have its own Rule Target.&nbsp;
While a Policy Target generally describes the kinds of requests to which an
entire policy applies, a Rule Target describes the kinds of request to which a
particular rule applies.&nbsp;&nbsp;&nbsp; If a Rule Target is not present, the
Policy Target is used to determine whether the Rule is applicable to an
incoming request.&nbsp; When a policy target exists, it is applicable to every
rule in the policy which does not have its own Target. In practice, a rule
target is often more constrained than the associated policy target, fine tuning
to specific Subject/Resource/Action match criteria that are in the context of a
the particular rule.&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>Refer to the documentation above for the <a
href="#POLICY-TARGET">Defining a Policy Target </a>for the structure of a
Target, since rule and policy Targets are defined using the same
elements.&nbsp;&nbsp;&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><b><span style='font-size:
10.0pt;font-family:"Courier New";color:black;background:white'>&lt;Condition&gt;</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>A Condition is a predicate that must be satisfied for a rule
to be assigned its effect.&nbsp; <b>&nbsp; </b>These predicates can be built
upon <a href="#POLICY-FUNCTIONS">XACML Functions</a>. <o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>While Targets are appealing, frame-like expressions, they
have a constrained logic which isn't always expressive enough to narrow down
whether a policy is applicable to a service request.&nbsp; Hence, the need for
Condition elements. &nbsp;&nbsp; If either the policy Target or the rule Target
is not able to adequately express a constraint, a Condition can be added to a
Rule. <b><i>&nbsp; A Condition can appear only within a Rule.</i></b>&nbsp; It
cannot appear within a Target, nor directly under Policy or
PolicySet.&nbsp;&nbsp;&nbsp; If a Condition is intended to be applicable to the
entire Policy, the Condition must be repeated in every Rule in that
Policy.&nbsp;&nbsp; Unlike the relationship of rule targets to policy targets,
conditions do in fact begin with the associate (rule or policy) target, and
proceed to further constrain that target. <o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=POLICY-FUNCTIONS><span style='font-family:
Arial'>2.5&nbsp; XACML Functions</span></a><span style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>The XACML specification defines numerous functions that can
be used in defining attribute match criteria in Targets and in defining
predicates for Conditions.&nbsp; Consult the <a
href="http://docs.oasis-open.org/xacml/access_control-xacml-2_0-core-spec-cd-04.pdf">XACML
Specification</a> for a complete list of functions with their
descriptions.&nbsp;&nbsp; For convenience, here is a small sampling of
convenient&nbsp; functions with their XACML identifiers:<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><b><span style='font-family:
Arial;color:black'>Equality predicates </span></b><span style='font-family:
Arial;color:black'>&nbsp;&nbsp; <o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l2 level1 lfo2;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>String
Equality </span></b><span style='font-family:Arial;color:black'>-&nbsp;
urn:oasis:names:tc:xacml:1.0:function:string-equal<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l2 level1 lfo2;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>Boolean
Equality </span></b><span style='font-family:Arial;color:black'>-
urn:oasis:names:tc:xacml:1.0:function:boolean-equal<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l2 level1 lfo2;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>Date/Time
Equality</span></b><span style='font-family:Arial;color:black'> -
urn:oasis:names:tc:xacml:1.0:function:dateTime-equal<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l2 level1 lfo2;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Arial;color:black'>others<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><b><span style='font-family:
Arial;color:black'>Logical functions</span></b><span style='font-family:Arial;
color:black'><o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l6 level1 lfo3;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>OR</span></b><span
style='font-family:Arial;color:black'> -
urn:oasis:names:tc:xacml:1.0:function:or<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l6 level1 lfo3;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>AND</span></b><span
style='font-family:Arial;color:black'> -
urn:oasis:names:tc:xacml:1.0:function:and<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l6 level1 lfo3;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>NOT</span></b><span
style='font-family:Arial;color:black'> -
urn:oasis:names:tc:xacml:1.0:function:not<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l6 level1 lfo3;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Arial;color:black'>others<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><b><span style='font-family:
Arial;color:black'>Comparison functions</span></b><span style='font-family:
Arial;color:black'><o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l1 level1 lfo4;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>Greater
Than</span></b><span style='font-family:Arial;color:black'> -
urn:oasis:names:tc:xacml:1.0:function:integer-greater-than<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l1 level1 lfo4;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>Less
Than</span></b><span style='font-family:Arial;color:black'> -
urn:oasis:names:tc:xacml:1.0:function:type-bag<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l1 level1 lfo4;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>Greater
Than or Equal</span></b><span style='font-family:Arial;color:black'> -&nbsp;
urn:oasis:names:tc:xacml:1.0:function:integer-greater-than-or-equal<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l1 level1 lfo4;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>Less
Than or Equal</span></b><span style='font-family:Arial;color:black'> - urn:oasis:names:tc:xacml:1.0:function:integer-less-than-or-equal<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l1 level1 lfo4;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>Date/Time
Greater Than</span></b><span style='font-family:Arial;color:black'> -
urn:oasis:names:tc:xacml:1.0:function:dateTime-greater-than<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l1 level1 lfo4;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Arial;color:black'>others<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><b><span style='font-family:
Arial;color:black'>Bag and Set functions</span></b><span style='font-family:
Arial;color:black'><o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l4 level1 lfo5;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>Bag
of Strings</span></b><span style='font-family:Arial;color:black'> -
urn:oasis:names:tc:xacml:1.0:function:string-bag<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l4 level1 lfo5;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:Arial;color:black'>Member
of Set </span></b><span style='font-family:Arial;color:black'>-
urn:oasis:names:tc:xacml:1.0:function:type-at-least-one-member-of<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l4 level1 lfo5;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Arial;color:black'>others<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>Below is an example Condition that uses several of these
functions.&nbsp; This Condition evaluates to TRUE if the client IP address
(from the environment of the incoming request) is NOT a member of a set of
privileged IP addresses.&nbsp;&nbsp; The Condition element itself contains an
outer-most function which is a <b><i>negation</i></b> <b><i>function</i></b>.&nbsp;&nbsp;
Within the condition, we see the application of the <b><i>set membership
function</i></b>, which specifies that the environment attribute
&quot;clientIpAddress&quot; (from the Fedora vocabulary) should be
evaluated.&nbsp; Finally, the inner most <b><i>bag function</i></b> wraps a set
of possible values for the clientIPAddress attribute.&nbsp; Again, if the
clientIpAddress on the incoming request is not one of those in the bag of
addresses, then the rule's Deny effect should take place.<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;Condition FunctionId=&quot;urn:oasis:names:tc:xacml:1.0:function:not&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Apply FunctionId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-at-least-one-member-of&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;EnvironmentAttributeDesignator AttributeId=&quot;urn:fedora:names:fedora:2.1:environment:httpRequest:clientIpAddress&quot;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>                                        </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;Apply FunctionId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-bag&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>            </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;127.0.0.1&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>            </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;128.84.103.11&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;/Apply&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Apply&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;/Condition&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

</div>

<p style='line-height:15.0pt'><b><span style='font-family:Arial;color:black'>&nbsp;</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>In summary, each policy must have at least one Rule.&nbsp;
For a Rule to have an effect, (1) the Rule must match the incoming request by
virtue of a Target match (either via a policy Target, or a constraining rule
Target), and (2) if a Condition is specified,&nbsp; the condition predicate
evaluates to TRUE.&nbsp;&nbsp; An applicable rule will result in a Permit or
Deny for an incoming request, based on what is specified in the Rule Effect.<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp; <o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=POLICY-OPT-ATTRS><span style='font-family:
Arial'>2.6 Required vs. Optional Attributes in a Policy</span></a><span
style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>There
are times when an attribute that is referred to by a policy target will not be
available on an incoming service request.&nbsp; By default, when the policy
matching activity occurs -&nbsp; and an attribute specified in a policy is not
found in the incoming request context -&nbsp; an Indeterminate result is
returned and an authorization exception is thrown.&nbsp; Policy authors can
avoid unwanted Indeterminate results by indicating in the attribute designators
of a Target or Condition that a particular attribute can be considered optional
in terms of whether it must existing in the incoming request
context.&nbsp;&nbsp; This is done by setting </span><span style='font-family:
"Courier New";color:black'>MustBePresent=&quot;false&quot;</span><span
style='font-family:Arial;color:black'> on a SubjectAttribututeDesignator,
ResourceAttributeDesignator, ActionAttributeDesignator, or
EnvironmentAttributeDesignator element.&nbsp;&nbsp;&nbsp; This will tell the
Fedora Policy Enforcement module that it's ok if the incoming request does not
have the specified attribute available within it. (The implicit/unstated
default is MustBePresent=&quot;true&quot;)&nbsp;&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Let's
take an example to make this clearer.&nbsp;&nbsp; Consider a policy where the
SubjectMatch specification talks about an attribute &quot;fedoraRole&quot; and
specifies that the value of this attribute must be &quot;administrator&quot; in
order for this policy to be considered applicable by the PDP.&nbsp;&nbsp; Now
consider an incoming service request that has a user login id (e.g.,&nbsp;
&quot;wdn5e&quot;) in the request context, but this user does not have a
&quot;fedoraRole&quot; attribute associated with it.&nbsp; So,&nbsp; when the
PEP tries to determine whether this policy is applicable to the incoming service
request, it returns INDETERMINATE because it can't figure out whether there is
a subject match without the presence of a &quot;fedoraRole&quot;
attribute.&nbsp;&nbsp; This will cause an authorization exception to be thrown
for the request because the PDP expects the &quot;fedoraRole&quot; attribute to
be present in the request context.&nbsp;&nbsp;&nbsp; However, we essentially
want to somehow indicate that the fedoraRole attribute is considered
&quot;optional&quot; on an incoming request&nbsp; (i.e., not every incoming request
must have this particular attribute in context).&nbsp;&nbsp; To do this, you
must indicate in the policy Target that the attribute does not have to be
present (&quot;</span><span style='font-family:"Courier New";color:black'>MustBePresent=&quot;false&quot;)</span><span
style='font-family:Arial;color:black'> in the incoming request as
follows:&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;Subjects&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Subject&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;SubjectMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;administrator&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;SubjectAttributeDesignator AttributeId=&quot;fedoraRole&quot; <b>MustBePresent=&quot;false&quot;</b> <o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>                 </span><span style='mso-spacerun:yes'>                 </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/SubjectMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Subject&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;/Subjects&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>In
this example, it's easy to imagine that another policy could independently
permit access. Hence the fit of MustBePresent=&quot;false&quot;: if the policy
above lacks an attribute, it may not be crucial to the ultimate authorization
decision. Policies are not authored in isolation, but to work together. <o:p></o:p></span></p>

<h2 style='mso-line-height-alt:15.0pt'><span style='font-family:Arial'>&nbsp;<o:p></o:p></span></h2>

<h3 style='line-height:15.0pt'><a name=POLICY-BEST><span style='font-family:
Arial'>2.7 Recommended Best Practices for Authoring Fedora XACML Policies</span></a><span
style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<ol start=1 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l0 level1 lfo6;
     tab-stops:list .5in;text-autospace:none'><span style='font-family:Arial'>Set
     the PolicyId attribute in the XACML policy to match the filename of the
     policy. <o:p></o:p></span></li>
</ol>

<p style='margin-left:.5in;line-height:15.0pt;text-autospace:none'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='margin-left:1.0in;line-height:15.0pt;text-autospace:none'><span
style='font-size:9.0pt;font-family:"Courier New";color:black;background:white'>&lt;Policy
PolicyId=&quot;deny-objects-to-students&quot; . . . &gt;&nbsp; </span><b><i><span
style='font-size:9.0pt;font-family:Arial;color:black;background:white'>corresponds
to filename of &quot;/repository-policies/deny-objects-to-students.xml&quot;</span></i></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='margin-left:1.0in;line-height:15.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black;background:white'>&nbsp;</span><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<ol start=2 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l0 level1 lfo6;
     tab-stops:list .5in;text-autospace:none'><span style='font-family:Arial'>For
     object-specific policies, especially if kept in an XML file, set the
     PolicyID in the XACML and the policy filename to match the object PID, but
     with concession to demand of OS filenames (e.g., uses dash instead of
     colon). <o:p></o:p></span></li>
</ol>

<p style='margin-left:.5in;line-height:15.0pt;text-autospace:none'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='margin-left:1.0in;line-height:15.0pt;text-autospace:none'><span
style='font-size:9.0pt;font-family:"Courier New";color:black;background:white'>&lt;Policy
PolicyId=&quot;demo-5&quot; . . . &gt;&nbsp; </span><b><i><span
style='font-size:9.0pt;font-family:Arial;color:black;background:white'>corresponds
to filename of &quot;/object-policies/demo-5.xml&quot;</span></i></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='margin-left:1.0in;line-height:15.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black;background:white'>&nbsp;</span><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<ol start=3 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l0 level1 lfo6;
     tab-stops:list .5in;text-autospace:none'><span style='font-family:Arial'>Policies
     should use simplest rule-combining algorithm which gives desired outcome.
     Avoid a more complicated algorithm which happens to work, but which
     confuses because it implies more than what's there.&nbsp; A simple choice
     is the &ldquo;first-applicable&rdquo; rule combining algorithm which give precedence
     to the first rule in a policy to apply to a situation. <o:p></o:p></span></li>
</ol>

<p style='margin-left:.5in;line-height:15.0pt;text-autospace:none'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='margin-left:1.0in;line-height:15.0pt;text-autospace:none'><span
style='font-size:9.0pt;font-family:"Courier New";color:black;background:white'>&lt;Policy
PolicyId=&quot;demo-5&quot;
RuleCombiningAlgId=&quot;urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable&quot;
. . . &gt;</span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='margin-left:1.0in;line-height:15.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black;background:white'>&nbsp;</span><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<ol start=4 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l0 level1 lfo6;
     tab-stops:list .5in;text-autospace:none'><span style='font-family:Arial'>An
     object-specific policy should be coded so that it applies only to that
     specific object. So-coded, if misplaced among general repository policies,
     that wouldn't be hurtful. <o:p></o:p></span></li>
</ol>

<p style='margin-left:.5in;line-height:15.0pt;text-autospace:none'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<ol start=5 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l0 level1 lfo6;
     tab-stops:list .5in;text-autospace:none'><span style='font-family:Arial'>Try
     to stick with &ldquo;single-effect&rdquo; policies, that is a policy should either
     permit or deny.&nbsp; Things can get confusing if a single policy has some
     rules that permit and some that deny.&nbsp;&nbsp; If most policies are
     single-effect, try to have them all be single-effect.&nbsp; You may wind
     up writing more individual policies, some that deny and some that permit,
     but from a policy management standpoint, it is probably easier to have
     atomic, unambiguous policies. <o:p></o:p></span></li>
</ol>

<p style='margin-left:.5in;line-height:15.0pt;text-autospace:none'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=POLICY-GOTCHA><span style='font-family:
Arial'>2.8 XACML Gotchas</span></a><span style='font-family:Arial'><o:p></o:p></span></h3>

</div>

<ol start=1 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l5 level1 lfo7;
     tab-stops:list .5in'><span style='font-family:Arial'>XACML provides for an
     AttributeValue in a &lt;Target&gt; evaluation as a single value, but
     provides for an AttributeValue in a &lt;Condition&gt; evaluation as
     &quot;bags&quot; (sets), doing so even for either singleton or empty
     bags.&nbsp; Code policies accordingly. <o:p></o:p></span></li>
</ol>

<p style='margin-left:.75in;line-height:15.0pt;text-autospace:none'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<ol start=2 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l5 level1 lfo7;
     tab-stops:list .5in'><span style='font-family:Arial'>MatchId functions
     (which are used in Targets) are much restricted in allowed values,
     compared to the values allowed in the analogous FunctionIds (which are
     used in Conditions).&nbsp; There are no existing functions which are
     self-contained boolean combinations, such as not-equal.&nbsp; Since
     attributes are generally not boolean themselves (and so possibly negated),
     the not function can't be used as a MatchId, e.g., in a SubjectMatch
     element.&nbsp; Since SubjectMatch, e.g., expresses a single binary
     operation, there is no possibility of introducing negative logic into a
     Target.&nbsp; [An exception would be an explicit value returned by an attribute
     finder, which would signify the absence of the attribute.] <o:p></o:p></span></li>
</ol>

<p style='margin-left:.75in;line-height:15.0pt;text-autospace:none'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<ol start=3 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l5 level1 lfo7;
     tab-stops:list .5in'><span style='font-family:Arial'>Despite some evidence
     that &lt;Environments&gt; was added to &lt;Target&gt; generally, it
     doesn't seem to work currently in sunxacml. <o:p></o:p></span></li>
</ol>

<p style='margin-left:.75in;line-height:15.0pt;text-autospace:none'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<ol start=4 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l5 level1 lfo7;
     tab-stops:list .5in'><span style='font-family:Arial'>&nbsp;sunxacml has a
     relaxed parsing of policies; e.g., we have encountered schema violation
     (e.g., Action omitted between Actions and ActionMatch) which resulted only
     in the policy not being evaluated correctly, as opposed to failing
     parse.&nbsp; How widespread this is, we don't know. As a precaution,
     policies should be tested for effect.&nbsp; This is good practice, anyway,
     since testing is the only check of the policy-writer's understanding of
     xacml and against the inevitable typ0. <o:p></o:p></span></li>
</ol>

<p style='margin-left:.75in;line-height:15.0pt;text-autospace:none'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<ol start=5 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l5 level1 lfo7;
     tab-stops:list .5in'><span style='font-family:Arial'>&nbsp;Though sunxacml
     parsing is relaxed, &lt;Description&gt; &lt;/Description&gt; apparently
     requires at least one-character content:&nbsp; &lt;Desciption/&gt; doesn't
     do it. <o:p></o:p></span></li>
</ol>

<p style='margin-left:.75in;line-height:15.0pt;text-autospace:none'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<ol start=6 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l5 level1 lfo7;
     tab-stops:list .5in;text-autospace:none'><span style='font-family:Arial'>In
     SubjectMatch, ResourceMatch, and ActionMatch blocks, place AttributeValue
     elements before AttributeDesignator. Also, avoid using two
     AttributeDesignator elements (without any AttributeValues). Though it may
     seem logical to use other ordering or attribute selection, it doesn't
     match the standard and won't work. <o:p></o:p></span></li>
</ol>

<p style='margin-left:.5in;line-height:15.0pt;text-autospace:none'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin-left:.5in;line-height:15.0pt;background:#DDDDFF;
text-autospace:none'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;line-height:15.0pt;background:#DDDDFF;
text-autospace:none'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;line-height:15.0pt;background:#DDDDFF;
text-autospace:none'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='margin-left:1.0in;line-height:15.0pt;background:#DDDDFF;text-autospace:
none'><span style='color:black'>&lt;ResourceMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:dateTime-less-than&quot;&gt;<o:p></o:p></span></pre><pre
style='margin-left:1.0in;line-height:15.0pt;background:#DDDDFF;text-autospace:
none'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#dateTime&quot;&gt;2004-12-07T20:22:26.705Z&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='margin-left:1.0in;line-height:15.0pt;background:#DDDDFF;text-autospace:
none'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;ResourceAttributeDesignator AttributeId=&quot;urn:fedora:names:fedora:2.1:resource:object:lastModifiedDate&quot; <o:p></o:p></span></pre><pre
style='margin-left:1.0in;line-height:15.0pt;background:#DDDDFF;text-autospace:
none'><span style='color:black'><span style='mso-spacerun:yes'>                               </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#dateTime&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin-left:.5in;line-height:15.0pt;background:#DDDDFF;
text-autospace:none'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='margin-left:1.0in;line-height:15.0pt;background:#DDDDFF;text-autospace:
none'><span style='color:black'>&lt;/ResourceMatch&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin-left:.5in;line-height:15.0pt;background:#DDDDFF;
text-autospace:none'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;line-height:15.0pt;background:#DDDDFF;
text-autospace:none'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;line-height:15.0pt;background:#DDDDFF;
text-autospace:none'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='margin-left:.5in;line-height:15.0pt;text-autospace:none'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h2 style='line-height:15.0pt'><a name=DEFAULT-REPOWIDE></a><span
style='font-size:14.0pt;font-family:Arial'>3 Default Repository-Wide Policies</span><span
style='font-family:Arial'><o:p></o:p></span></h2>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>out-of-the-box,
the Fedora repository is configured with a default set of access control
policies that provide for a highly restricted management service (API-M), an
open access service&nbsp; (API-A), and an open OAI provider
service.&nbsp;&nbsp; These default access control policies establish the same
level of out-of-the-box security on the repository that was previously
configured for Fedora 2.0 release; however, as of Fedora 2.1 these basic access
controls are now specified as XACML policies.&nbsp;&nbsp; Please consult the <a
href="#DEFAULT">Default Repository Policies</a> documentation for a description
of each default policy. <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h2 style='line-height:15.0pt'><a name=CUSTOM-REPO-WIDE></a><span
style='font-size:14.0pt;font-family:Arial'>4 Custom Policies - Sample
Repository-Wide Policies</span><span style='font-family:Arial'><o:p></o:p></span></h2>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>The
sample policies are written with the assumption that Fedora's <a
href="AuthorizationXACML.htm#DEFAULT">Default Repository-Wide Policies</a> are
unedited and activated.&nbsp;&nbsp;&nbsp; These default policies lock down
access to the Fedora API-M service so that only the Fedora Administrator is
permitted access.&nbsp; The default policies also result in open access to
API-A (all users are permitted).&nbsp;&nbsp; Given this starting point,&nbsp;
you can think writing custom policies as a way to &quot;loosen up&quot;&nbsp;
the API-M defaults and &quot;tighten up&quot; the API-I defaults.&nbsp; In
other words, it is likely that you will want to write policies that let more
users have access to API-M operations.&nbsp; Also, you will likely want to add
restrictions in who can access digital objects, datastreams, and disseminations
(i.e., via API-A).&nbsp;&nbsp; The sample policies will demonstrate how to do
these things, given various authentication scenarios.&nbsp; Notice that there
are some policies which restrict access based on user identity/attributes based
on Tomcat's default user directory ( tomcat-users.xml).&nbsp; Other policies
demonstrate how to restrict access by user attributes/groups that are defined
in an LDAP directory.&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Note
that the sample policies have been written for demonstration
purposes.&nbsp;&nbsp; They are not intended to work as a collaborative set of
policies, since they often demonstrate different ways of of doing the same
basic thing (e.g., one policy demonstrating rules based on Tomcat user
identity, another showing a similar thing with LDAP groups).&nbsp;&nbsp; If you
want to try them out, you can put one or more of the sample policies into play
by following the instructions for <a
href="AuthorizationXACML.htm#CONFIG-ACTIVATE">activating and loading policies</a>
into a Fedora repository.&nbsp; However, it is recommended that you test them
individually to understand the effect each policy has.&nbsp;&nbsp; This
approach of augmenting the default policies, which are left as-is, allows
progressive learning, without endangering your repository. It may be that this
approach goes farther in opening up API-M than in tighting up API-I, and that
eventually the default policy for API-A will need to be replaced by one or more
policies written to your site's needs. So it goes. Ultimately, you can proceed
to write a meaningful suite of policies that are intended to work together for
your repository. &nbsp;&nbsp;&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><span style='font-family:Arial'>4.1&nbsp;
Repository Policies to <i>tighten</i> the API-A defaults at the <i>service</i> <i>interface</i>
level<o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>Service</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=316 style='width:237.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp;XACML Policy File</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp; Policy Description</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.1.1<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=316 style='width:237.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-all-methods/deny-apia-to-ldap-group.xml">deny-apia-to-ldap-group.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>Deny
  access to all API-A methods to users who are &ldquo;Librarians&rdquo; or &ldquo;Info
  Technologists&rdquo; (as indicated by their LDAP attributes).</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.1.2<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=316 style='width:237.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-all-methods/deny-apia-if-not-tomcat-role.xml">deny-apia-if-not-tomcat-role.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY access to ALL API-A methods to users who are NOT in the
  &ldquo;administrator&rdquo; or &ldquo;professor&rdquo; ROLES.</span><span style='font-family:Arial;
  color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.1.3<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=316 style='width:237.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-all-methods/deny-apia-to-tomcat-user.xml">deny-apia-to-tomcat-user.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will deny access to all API-A methods to a particular user based on
  login id (as registered in the tomcat-users.xml file).</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.1.4<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=316 style='width:237.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-all-methods/deny-apia-except-by-owner.xml">deny-apia-except-by-owner.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>Deny access to 
  all API-A methods to any user unless that user is the owner of the object being accessed. 
  This sample policy primarily exists to show how to create a policy that compares the 
  owner-id of an object to the login-id of the current user. It is important to note that 
  due to how XACML policies are processed, you <b>cannot</b> do this comparison in the &lt;Subject&gt; 
  section of the XACML policy. The comparison must appear in a &lt;Condition&gt; specification 
  in the &lt;Rule&gt; section.</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><span style='font-family:Arial'>4.2&nbsp;
Repository Policies to <i>tighten</i> the API-A defaults based on <i>object
attributes</i><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>Service</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=317 style='width:237.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp;XACML Policy File</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp; Policy Description</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.2.1<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=317 style='width:237.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-objects-by-attributes/deny-objects-by-pids-to-tomcat-role.xml">deny-objects-by-pids-to-tomcat-role.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>Overall,
  this policy will identify a set of objects by their PIDs and it will DENY ALL
  APIA access to users of particular ROLES.&nbsp; NOTE:&nbsp; As a
  repository-wide policy, this policy demonstrates how to control access to
  specific objects (identified by PID).&nbsp; As an alternative, it is possible
  to create &lsquo;object-specific&rsquo; policies that either resides in the digital
  object's POLICY datastream, or that is stored in the object-specific policy
  directory.&nbsp; (See the Fedora system documentation on XACML policies for
  more information.)</span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.2.2<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=317 style='width:237.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-objects-by-attributes/deny-objects-by-cmodel-to-ldap-group.xml">deny-objects-by-cmodel-to-ldap-group.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY all APIA access to digital objects that are EAD Finding
  AIDS.&nbsp; This is based on the object content model attribute having a
  value of &quot;UVA_EAD_FINDING_AID.&quot;&nbsp; Specifically, the policy will DENY
  access to users that belong to a particular LDAP-defined GROUP.</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.2.3<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=317 style='width:237.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-objects-by-attributes/deny-objects-hide-datastreams-if-not-tomcat-role.xml">deny-objects-hide-datastreams-if-not-tomcat-role.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>The
  overall intent of this policy is datastream hiding, meaning that raw
  datastreams must not be accessible to anyone except very privileged users,
  but service-mediated disseminations are accessible by a broader
  audience.&nbsp; The key point is that students can access disseminations of
  the object, but not the raw datastreams.&nbsp; This is might typically be
  done in cases where lesser privleged users are given a derivation of the main
  datastream, or a lesser quality view, or a less complete view of the raw
  datastream content.&nbsp; Given that an object is of a certain content model
  (in this case UVA_STD_IMAGE), this policy will DENY datastream access to
  users who do NOT have the ROLE of &lsquo;administrator&rsquo; or &lsquo;professor&rsquo;. It will also
  DENY dissemination access to users who do NOT have the ROLE of &lsquo;student,&rsquo;
  &lsquo;administrator,&rsquo; or &lsquo;professor.&rsquo;</span><span style='font-family:Arial;
  color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><span style='font-family:Arial'>4.3&nbsp;
Repository Policies to <i>tighten</i> the API-A defaults at the <i>datastream</i>
level<o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>Service</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=317 style='width:237.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp;XACML Policy File</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp; Policy Description</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.3.1<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=317 style='width:237.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-datastreams/deny-apia-datastream-all-to-all-users.xml">deny-apia-datastream-all-to-all-users.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY access to ALL datastreams.&nbsp; Specifically, it will DENY
  access to ALL USERS making requests to the getDatastreamDissemination method
  of API-A.</span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.3.2<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=317 style='width:237.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-datastreams/deny-apia-datastream-DC-to-all-users.xml">deny-apia-datastream-DC-to-all-users.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY access to Dublin Core datastreams.&nbsp; Specifically, it
  will DENY access to ALL users making getDatastreamDissemination requests on
  API-A to obtain datastreams with an identifier of 'DC.'</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.3.3<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=317 style='width:237.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-datastreams/deny-apia-datastream-DC-to-tomcat-group-ALT1.xml">deny-apia-datastream-DC-to-tomcat-group-ALT1.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY access to Dublin Core datastreams.&nbsp; Specifically, it
  will deny access to USER GROUPS making getDatastreamDissemination requests on
  API-A for datastreams with a datastream identifier of 'DC.'&nbsp; User groups
  are defined using custom roles in the tomcat-users.xml file.</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.3.4<o:p></o:p></span></p>
  </td>
  <td width=59 style='width:44.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=317 style='width:237.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-datastreams/deny-apia-datastream-DC-to-tomcat-group-ALT2.xml">deny-apia-datastream-DC-to-tomcat-group-ALT2.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY access to Dublin Core datastreams.&nbsp; Specifically, it
  will deny access to USER GROUPS making getDatastreamDissemination requests on
  API-A for datastreams with a datastream identifier of 'DC.'&nbsp; User groups
  are defined using custom roles in the tomcat-users.xml file.</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.3.5<o:p></o:p></span></p>
  </td>
  <td width=59 style='width:44.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=317 style='width:237.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-datastreams/deny-apia-datastream-MRSID-if-not-tomcat-role.xml">deny-apia-datastream-MRSID-if-not-tomcat-role.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY access to MRSID image datastreams by controlling access to
  the getDatastreamDissemination method of the Fedora Access Service
  (API-A).&nbsp; Specifically, it will DENY access to users who are NOT of
  particular ROLES when the requested resource is a datastream with identifier
  of 'MRSID.'</span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.3.6<o:p></o:p></span></p>
  </td>
  <td width=59 style='width:44.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=317 style='width:237.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-datastreams/deny-apia-datastream-TEISOURCE-to-tomcat-user.xml">deny-apia-datastream-TEISOURCE-to-tomcat-user.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY access to TEI datastreams by controlling access to the
  getDatastreamDissemination method of the Fedora Access Service (API-A).&nbsp;
  The TEI datastream is identified as a Resource where the Fedora datastream id
  has the value of 'TEISOURCE.'&nbsp;&nbsp; This policy will DENY access to a
  SPECIFIC USER based on login id (as registered in the tomcat-users.xml file).</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><span style='font-family:Arial'>4.4&nbsp;
Repository Policies to <i>tighten</i> the API-A defaults at the <i>dissemination</i>
level<o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>Service</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=343 style='width:257.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp;XACML Policy File</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp; Policy Description</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.4.1<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=343 style='width:257.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-disseminations/deny-apia-dissem-demo1-getMedium-to-all-users.xml">deny-apia-dissem-demo1-getMedium-to-all-users.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY access to the 'demo:1/getMedium' dissemination (defined on a
  disseminator that subscribes to the demo:1 behavior definition.&nbsp;&nbsp;
  Specifically, it will DENY access to ALL users making getDissemination
  requests on API-A for the 'demo:1/getMedium' dissemination.</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.4.2<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=343 style='width:257.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-disseminations/deny-apia-dissem-demo1-getMedium-to-ldap-group.xml">deny-apia-dissem-demo1-getMedium-to-ldap-group.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY access to the 'demo:1/getMedium' dissemination (defined on a
  disseminator that subscribes to the demo:1 behavior definition.&nbsp;&nbsp;
  Specifically, it will DENY access to users of particular LDAP-defined GROUPS
  who are making getDissemination requests on API-A&nbsp; for the
  'demo:1/getMedium' dissemination.</span><span style='font-family:Arial;
  color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.4.3<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=343 style='width:257.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-disseminations/deny-apia-dissem-demo1-getMedium-if-not-tomcat-role.xml">deny-apia-dissem-demo1-getMedium-if-not-tomcat-role.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY access to the 'demo:1/getMedium' dissemination (defined on a
  disseminator that subscribes to the demo:1 behavior definition.&nbsp;&nbsp;
  Specifically, it will DENY access to users who are NOT of particular ROLES
  who are making getDissemination requests on API-A for the 'demo:1/getMedium'
  dissemination.</span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.4.4<o:p></o:p></span></p>
  </td>
  <td width=59 style='width:44.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=343 style='width:257.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-disseminations/deny-apia-dissem-demo1-getMedium-to-tomcat-user.xml">deny-apia-dissem-demo1-getMedium-to-tomcat-user.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY access to disseminations that are available on objects via a
  disseminator subscribing to the 'demo:2' behavior definition.&nbsp;
  Specifically, it will DENY access to a particular user (as registered
  in&nbsp; the tomcat-users.xml file).</span><span style='font-family:Arial;
  color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.4.5<o:p></o:p></span></p>
  </td>
  <td width=59 style='width:44.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A<o:p></o:p></span></p>
  </td>
  <td width=343 style='width:257.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apia-tighten-defaults/apia-restrict-disseminations/deny-apia-dissem-DualResImage-to-all-users.xml">deny-apia-dissem-DualResImage-to-all-users</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black;background:white'>This
  policy will DENY access to ALL disseminations that are available on objects
  via a particular disseminator (one that subscribes to an image-based behavior
  definition whose PID is 'demo:DualResImage'.&nbsp; Specifically,&nbsp; it
  will DENY access to ALL users making getDissemination requests on this
  disseminator.</span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><span style='font-family:Arial'>4.5&nbsp;
Repository Policies to <i>loosen</i> the API-M defaults at the <i>service</i> <i>interface</i>
level<o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>Service</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=284 style='width:213.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp;XACML Policy File</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp; Policy Description</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.5.1<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-M<o:p></o:p></span></p>
  </td>
  <td width=284 style='width:213.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apim-loosen-defaults/apim-permit-all-methods/permit-apim-by-ldap-group.xml">permit-apim-by-ldap-group.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.5.2<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-M<o:p></o:p></span></p>
  </td>
  <td width=284 style='width:213.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apim-loosen-defaults/apim-permit-all-methods/permit-apim-by-tomcat-group.xml">permit-apim-by-tomcat-group.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.5.3<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-M<o:p></o:p></span></p>
  </td>
  <td width=284 style='width:213.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/apim-loosen-defaults/apim-permit-all-methods/permit-apim-by-tomcat-user.xml">permit-apim-by-tomcat-user.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>
  </td>
  </tr>

  <tr>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4.5.4<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>API-A/API-M<o:p></o:p></span></p>
  </td>
  <td width=284 style='width:213.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-repository-policies/permit-if-owner.xml">permit-if-owner.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>
  If the logged-in user is the owner of an object, permit all actions.
  Note: This policy also works if the object has 
  <a href="AuthorizationXACML.htm#CONFIG-OWNER-ID">multiple owners</a>
  and the logged-in user is one of them.
  </span></p>
  </td>
  </tr>

</table>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h2 style='line-height:15.0pt'><a name=CUSTOM-OBJ-SPECIFIC></a><span
style='font-size:14.0pt;font-family:Arial'>5 Custom Policies - Sample
Object-Specific Policies</span><span style='font-family:Arial'><o:p></o:p></span></h2>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><span style='font-family:Arial'>5.1 Object-specific
policies with multiple policy rules<o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Object-specific
policies are policies that refer to one particular digital object.&nbsp;&nbsp;
An object-specific policy is stored in the &quot;POLICY&quot; datastream of
the digital object to which it pertains.&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>Service</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=284 style='width:213.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp;XACML Policy File</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp; Policy Description</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>5.1.1<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>N/A<o:p></o:p></span></p>
  </td>
  <td width=284 style='width:213.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-object-policies/demo-5.xml">demo-5.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'><span style='background:url('')'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>By using <b><i>multiple
  policy rules</i></b>, this policy shows how to deny access to all raw
  datastreams in the object except to particular users (e.g., the object
  owners). It also shows how to deny access to a particular disseminations to
  selected user roles.</span></span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>5.1.2<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>N/A<o:p></o:p></span></p>
  </td>
  <td width=284 style='width:213.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-object-policies/demo-11.xml">demo-11.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'><span style='background:url('')'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>By using <b><i>multiple
  policy rules</i></b>, this policy shows how to deny access to particular
  datastreams in the object. 1) The policy will DENY everyone except professors
  and researchers access to -particular- source datastreams of the demo:11
  object by controlling access to the getDatastreamDissemination method of the
  Fedora Access Service (API-A). 2) The policy will DENY everyone except
  students, professors, and researchers, access to all disseminations of
  demo:11. 3) This policy will also DENY ALL access to the demo:11 object to a
  SPECIFIC USER based on login id (as registered in the tomcat-users.xml file).
  NOTE: The net effect of the policy permits open access to the descriptive
  metadata datastream of demo:11.</span></span><span style='font-family:Arial;
  color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>5.1.3<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>N/A<o:p></o:p></span></p>
  </td>
  <td width=284 style='width:213.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/examples/example-object-policies/demo-26.xml">demo-26.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'><span style='background:url('')'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>By using <b><i>multiple
  policy rules</i></b>, this policy shows how to deny access to particular
  datastreams in the object. The policy will DENY visitors access to the TEI
  and FOP source datastreams of the demo:26 object by controlling access to the
  getDatastreamDissemination method of the Fedora Access Service (API-A). These
  datastreams are open to all other kinds of users, and Disseminations are open
  to all users. This is an object-specific policy. It could be stored inside the
  demo:26 digital object in the POLICY datastream OR in the directory for
  object-specific policies. (The directory location is set in the Authorization
  module configuration in the Fedora server configuration file (fedora.fcfg).</span></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-size:14.0pt;font-family:
Arial;color:black'>&nbsp;</span></b><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

</div>

</div>

    <div id="footer">
      <div id="copyright">
        Copyright &copy; 2006-2007 Fedora Project; 2008 Fedora Commons, Inc.
      </div>
    </div>

</body>

</html>
